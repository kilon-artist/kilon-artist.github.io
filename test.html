//#region Function to recalculate and set height
function recalculateLineHeights() {
  // Create a promise to handle image load completion
  const promises = [];

  document.querySelectorAll('.pswp-gallery__item').forEach(item => {
    const thumbnail = item.querySelector('.thumbnail');
    const line = item.querySelector('.line');


    if (thumbnail && line ) {
      // Create a promise for each image to ensure it's loaded
      const imageLoadPromise = new Promise((resolve) => {
        if (thumbnail.complete) {
          // Image already loaded
          resolve();
        } else {
          // Wait for image to load
          thumbnail.addEventListener('load', resolve);
          thumbnail.addEventListener('error', resolve); // Handle image load errors
        }
      });

      promises.push(imageLoadPromise);

      // Once the image is loaded, calculate the height
      imageLoadPromise.then(() => {
        const itemTop = item.getBoundingClientRect().top;
        const thumbnailTop = thumbnail.getBoundingClientRect().top;
        const newHeight = thumbnailTop - itemTop - 5;

        line.style.height = `${newHeight}px`;
      });
    }
  });

  // Wait for all image load promises to complete
  return Promise.all(promises);
}

// Simulate Isotope filtering
function performFiltering() {
  return new Promise(resolve => {
    // Simulate filtering delay
    setTimeout(() => {
      // Your Isotope filtering code here
      resolve();
    }, 500); // Adjust delay as needed
  });
}
//#endregion Function to recalculate and set height